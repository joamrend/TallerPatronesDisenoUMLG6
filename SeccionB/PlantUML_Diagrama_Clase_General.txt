DC

@startuml Sistema_General_Clases
skinparam ClassAttributeIconStyle relevant

' ----------------------------------
' PAQUETE: ENTIDADES DE NEGOCIO (CORE)
' ----------------------------------
package "Entidades Core" {
    class Producto {
        - id: int
        - nombre: string
        - estado: string
        - precioVenta: decimal
        --
    }

    class Tienda {
        - id: int
        - nombre: string
    }

    class Bodega {
        - id: int
        - nombre: string
    }

    class InventarioNacional {
        - productos: List<Producto>
    }

    Producto "*" -- "1" Tienda : ubicado_en
    Producto "*" -- "1" Bodega : almacenado_en
    InventarioNacional "1" o-- "*" Producto : contiene
}

' ----------------------------------
' PAQUETE: PATRÓN ITERATOR (Navegación)
' ----------------------------------
package "Iterator (Navegación)" {
    interface IIterator {
        + Siguiente(): Producto
        + TieneMas(): boolean
    }
    interface IAggregate {
        + CrearIterator(tipo: string): IIterator
    }
    
    AbstractIterator .up.|> IIterator
    InventarioNacional .up.|> IAggregate
    
    abstract class AbstractIterator {
        # coleccion: IAggregate
    }
    class IteradorCompradorWeb {}
    class IteradorProveedorFallas {}

    AbstractIterator <|-- IteradorCompradorWeb
    AbstractIterator <|-- IteradorProveedorFallas
}

' ----------------------------------
' PAQUETE: PATRÓN STRATEGY (Distribución)
' ----------------------------------
package "Strategy (Logística)" {
    interface IDistributionStrategy {
        + Distribuir(productos, destino: Bodega): boolean
    }
    class LogisticaDepartamento {
        - estrategia: IDistributionStrategy
        + SetEstrategia(estrategia: IDistributionStrategy): void
    }
    
    IDistributionStrategy <|.. EstrategiaAutomotriz
    IDistributionStrategy <|.. EstrategiaFerrea
    
    class EstrategiaAutomotriz {}
    class EstrategiaFerrea {}
    
    LogisticaDepartamento "1" o-- "1" IDistributionStrategy : utiliza
}

' ----------------------------------
' PAQUETE: PATRÓN CHAIN OF RESPONSIBILITY (Garantía)
' ----------------------------------
package "Chain of Responsibility (Garantía)" {
    class SolicitudCambio {
        - producto: Producto
        - precioVenta: decimal
        - estado: string
    }
    
    interface IGarantiaHandler {
        + SetSiguiente(h): IGarantiaHandler
        + ManejarSolicitud(s: SolicitudCambio): SolicitudCambio
    }
    abstract class AbstractHandler {
        # siguienteHandler: IGarantiaHandler
    }
    
    IGarantiaHandler <|.. AbstractHandler
    
    class AsistenteGarantia {}
    class ExpertoTecnico {}
    class JefeInventario {}
    class GerenteTienda {}

    AbstractHandler <|-- AsistenteGarantia
    AbstractHandler <|-- ExpertoTecnico
    AbstractHandler <|-- JefeInventario
    AbstractHandler <|-- GerenteTienda
    
    AbstractHandler "1" o--> "0..1" IGarantiaHandler : siguienteHandler
    
    GerenteTienda "1" -- "1" Tienda : asociado_a
}

' ----------------------------------
' CONEXIONES ENTRE PATRONES
' ----------------------------------
' Conexión Chain of Responsibility a Core:
SolicitudCambio "1" -- "1" Producto : para
' Conexión Strategy a Core:
LogisticaDepartamento --> Bodega : distribuye_a
@enduml